<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>The state of my Homelab in 2025 | Alecks</title>
<meta name="keywords" content="servers, homelab, self-hosting">
<meta name="description" content="Currently my Homelab is used to run services for personal use, my stuff exposed to the internet and VMs for friends or people in my local community.
The original goal of this setup was to build a service that lets me cancel all of my vps subscriptions, which so far has succeeded, the next goal is to make the service as reliable or close to as reliable as a proper hosting provider.">
<meta name="author" content="Alecks">
<link rel="canonical" href="http://localhost:1313/posts/homelab-2025/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.36819bea596090d8b48cf10d9831382996197aa7e4fc86f792f7c08c9ca4d23b.css" integrity="sha256-NoGb6llgkNi0jPENmDE4KZYZeqfk/Ib3kvfAjJyk0js=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicons/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/homelab-2025/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="http://localhost:1313/posts/homelab-2025/">
  <meta property="og:site_name" content="Alecks">
  <meta property="og:title" content="The state of my Homelab in 2025">
  <meta property="og:description" content="Currently my Homelab is used to run services for personal use, my stuff exposed to the internet and VMs for friends or people in my local community.
The original goal of this setup was to build a service that lets me cancel all of my vps subscriptions, which so far has succeeded, the next goal is to make the service as reliable or close to as reliable as a proper hosting provider.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-09-03T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-09-03T00:00:00+00:00">
    <meta property="article:tag" content="Servers">
    <meta property="article:tag" content="Homelab">
    <meta property="article:tag" content="Self-Hosting">
      <meta property="og:image" content="http://localhost:1313/images/papermod-cover.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/images/papermod-cover.png">
<meta name="twitter:title" content="The state of my Homelab in 2025">
<meta name="twitter:description" content="Currently my Homelab is used to run services for personal use, my stuff exposed to the internet and VMs for friends or people in my local community.
The original goal of this setup was to build a service that lets me cancel all of my vps subscriptions, which so far has succeeded, the next goal is to make the service as reliable or close to as reliable as a proper hosting provider.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "The state of my Homelab in 2025",
      "item": "http://localhost:1313/posts/homelab-2025/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "The state of my Homelab in 2025",
  "name": "The state of my Homelab in 2025",
  "description": "Currently my Homelab is used to run services for personal use, my stuff exposed to the internet and VMs for friends or people in my local community.\nThe original goal of this setup was to build a service that lets me cancel all of my vps subscriptions, which so far has succeeded, the next goal is to make the service as reliable or close to as reliable as a proper hosting provider.\n",
  "keywords": [
    "servers", "homelab", "self-hosting"
  ],
  "articleBody": "Currently my Homelab is used to run services for personal use, my stuff exposed to the internet and VMs for friends or people in my local community.\nThe original goal of this setup was to build a service that lets me cancel all of my vps subscriptions, which so far has succeeded, the next goal is to make the service as reliable or close to as reliable as a proper hosting provider.\nCompute Nodes Lightsail is my main machine running pretty much everything, Railway is used for monitoring and failover, they currently sit on a shelf but I plan to build a server rack and add some more machines later on.\nBoth machines run Proxmox VE clustered together and host various virtual machines.\nName CPU RAM Storage Lightsail Ryzen 5 5500 32GB DDR4 1TB SSD Railway Intel i5-7400T 8GB DDR4 256GB SSD Networking Internet Line Being in Australia on the NBN, I have an FTTP (Fibre to the Premises) connection, essentially a full fibre line which is perfect for reliability and performance.\nMy ISP is small and reasonably priced, they’ve never had an outage on my line and I consistently get full speeds with zero congestion. They even provide built-in inline DDoS Protection with GSL for no extra cost. On top of that, their support actually knows what they’re talking about while taking less than a day to respond over email, probably one of the best setups you could possibly have for Homelabbing.\nLocal Network As my main router I use a Ubiquiti Edgerouter 4, an enterprise-grade business router built for performance, reliability and high uptime.\nMy network is segmented into 2 vLANs: one for my home network and another for my Homelab, this ensures that any breaches in my infrastructure don’t spread to vulnerable IoT devices or other home devices.\nExposing Services Since my network has a static IP address, most public services are exposed via port forwarding. I run multiple web services so I have a central Caddy LXC container sitting on port 80/443 which forwards web traffic to all the backend VMs.\nFor some more critical or vulnerable services like Apache Guacamole \u0026 PhpMyAdmin I expose them with Cloudflare Tunnels behind Cloudflare Access for added security.\nDiagram of everything I have directly exposed to the Internet.\nWhat I’m running on it Kasm Workspaces This is a software that lets you run desktops or browsers in containers on your server and stream them in browser to your local machine over local network or the internet. I use it for running Kali Linux labs for penetration testing and spinning up a browser when DNS changes are taking a while to update on my machine.\nIt may also get a lot more use during my Tafe courses (If I get in), since I’ll be taking an M4 Macbook Air I won’t be able to run x86 Linux VMs but this service will let me do that.\nA Kali Linux container running on my Kasm VM.\nPterodactyl Panel \u0026 Wings This allows me to create and manage all of my game servers with a clean web interface while using secure isolated docker containers on the backend and provide game servers to friends or the local community.\nGitea A self-hosted GitHub/GitLab alternative, I trust GitHub more with durability so I mainly use my Gitea server for mirrors incase something happens to GitHub or my account on it.\nTor Relay (Middle) Tor is a decentralized system for anonymous communication that hides a users ip address by routing their internet traffic through a series of volunteer-run, encrypted relays.\nI’m one of the volunteers your traffic gets routed through when using the network, I run a middle relay as its the least dangerous when it comes to law enforcement knocking at your door asking for traffic logs (If a criminal uses your relay for illegal activities).\nVPS Servers I operate a small service for friends or people in my local community offering small linux VMs hosted in my homelab for free - find more about how that works here.\nReliability My goal of building my own hosting platform more reliable than a proper hosting provider is pretty much impossible without being in a datacenter, as homes typically don’t have multiple internet lines or onsite diesel generators. However, I’m in the position where I can achieve relatively close to that level with my setup or at least good enough for my needs.\nPower: Extremely reliable, I live in a fairly new area with pretty solid power infrastructure. My next upgrade will definitely be adding a UPS. Internet: I haven’t had a single outage on my Internet line, speeds are always consistent with no congestion. Services Interfering: All services run in their own VMs with strict resource allocations. If one service crashes or maxxes out resources, nothing else is affected. Backups I follow the industry-standard 3-2-1 rule where you have a copy on production, an onsite backup and an offsite backup. I run a Proxmox Backup Server onsite which is then sent up to Backblaze B2.\nMonitoring Even though I do want to setup a proper onsite monitoring system with Prometheus \u0026 Grafana as a future project, HetrixTools is super easy to setup and does everything I need it to do - monitor uptime, system resources, network usage and active processes of each Node \u0026 VM.\nConclusion Even though my Homelab is in a great state for my needs, it can always improve, a few things I still want to do with it include:\nSetup an onsite monitoring system with Prometheus \u0026 Grafana Add a UPS to protect data integrity and keep systems up during short power outages Build a proper server rack and add more compute nodes (Including a proper storage server with multiple TBs of storage) And more stuff will definitely come up throughout the years.\nThanks for reading.\n",
  "wordCount" : "974",
  "inLanguage": "en",
  "image": "http://localhost:1313/images/papermod-cover.png","datePublished": "2025-09-03T00:00:00Z",
  "dateModified": "2025-09-03T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Alecks"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/homelab-2025/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Alecks",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicons/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Alecks (Alt + H)">Alecks</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/skills/" title="Skills">
                    <span>Skills</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/homelab/" title="Homelab">
                    <span>Homelab</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      The state of my Homelab in 2025
    </h1>
    <div class="post-meta"><span title='2025-09-03 00:00:00 +0000 UTC'>September 3, 2025</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Alecks

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#compute-nodes" aria-label="Compute Nodes">Compute Nodes</a></li>
                <li>
                    <a href="#networking" aria-label="Networking">Networking</a><ul>
                        
                <li>
                    <a href="#internet-line" aria-label="Internet Line">Internet Line</a></li>
                <li>
                    <a href="#local-network" aria-label="Local Network">Local Network</a></li></ul>
                </li>
                <li>
                    <a href="#exposing-services" aria-label="Exposing Services">Exposing Services</a></li>
                <li>
                    <a href="#what-im-running-on-it" aria-label="What I&rsquo;m running on it">What I&rsquo;m running on it</a><ul>
                        
                <li>
                    <a href="#kasm-workspaces" aria-label="Kasm Workspaces">Kasm Workspaces</a></li>
                <li>
                    <a href="#pterodactyl-panel--wings" aria-label="Pterodactyl Panel &amp; Wings">Pterodactyl Panel &amp; Wings</a></li>
                <li>
                    <a href="#gitea" aria-label="Gitea">Gitea</a></li>
                <li>
                    <a href="#tor-relay-middle" aria-label="Tor Relay (Middle)">Tor Relay (Middle)</a></li>
                <li>
                    <a href="#vps-servers" aria-label="VPS Servers">VPS Servers</a></li></ul>
                </li>
                <li>
                    <a href="#reliability" aria-label="Reliability">Reliability</a><ul>
                        
                <li>
                    <a href="#backups" aria-label="Backups">Backups</a></li>
                <li>
                    <a href="#monitoring" aria-label="Monitoring">Monitoring</a></li></ul>
                </li>
                <li>
                    <a href="#conclusion" aria-label="Conclusion">Conclusion</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>Currently my Homelab is used to run services for personal use, my stuff exposed to the internet and VMs for friends or people in my local community.</p>
<p>The original goal of this setup was to build a service that lets me cancel all of my vps subscriptions, which so far has succeeded, the next goal is to make the service as reliable or close to as reliable as a proper hosting provider.</p>
<h2 id="compute-nodes">Compute Nodes<a hidden class="anchor" aria-hidden="true" href="#compute-nodes">#</a></h2>
<p>Lightsail is my main machine running pretty much everything, Railway is used for monitoring and failover, they currently sit on a shelf but I plan to build a server rack and add some more machines later on.</p>
<p>Both machines run Proxmox VE clustered together and host various virtual machines.</p>
<table>
  <thead>
      <tr>
          <th>Name</th>
          <th>CPU</th>
          <th>RAM</th>
          <th>Storage</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Lightsail</td>
          <td>Ryzen 5 5500</td>
          <td>32GB DDR4</td>
          <td>1TB SSD</td>
      </tr>
      <tr>
          <td>Railway</td>
          <td>Intel i5-7400T</td>
          <td>8GB DDR4</td>
          <td>256GB SSD</td>
      </tr>
  </tbody>
</table>
<h2 id="networking">Networking<a hidden class="anchor" aria-hidden="true" href="#networking">#</a></h2>
<h3 id="internet-line">Internet Line<a hidden class="anchor" aria-hidden="true" href="#internet-line">#</a></h3>
<p>Being in Australia on the NBN, I have an FTTP (Fibre to the Premises) connection, essentially a full fibre line which is perfect for reliability and performance.</p>
<p>My ISP is small and reasonably priced, they&rsquo;ve never had an outage on my line and I consistently get full speeds with zero congestion. They even provide built-in inline DDoS Protection with <a href="https://globalsecurelayer.com/ddos-protection">GSL</a> for no extra cost. On top of that, their support actually knows what they&rsquo;re talking about while taking less than a day to respond over email, probably one of the best setups you could possibly have for Homelabbing.</p>
<h3 id="local-network">Local Network<a hidden class="anchor" aria-hidden="true" href="#local-network">#</a></h3>
<p>As my main router I use a Ubiquiti Edgerouter 4, an enterprise-grade business router built for performance, reliability and high uptime.</p>
<p>My network is segmented into 2 vLANs: one for my home network and another for my Homelab, this ensures that any breaches in my infrastructure don&rsquo;t spread to vulnerable IoT devices or other home devices.</p>
<h2 id="exposing-services">Exposing Services<a hidden class="anchor" aria-hidden="true" href="#exposing-services">#</a></h2>
<p>Since my network has a static IP address, most public services are exposed via port forwarding. I run multiple web services so I have a central Caddy LXC container sitting on port 80/443 which forwards web traffic to all the backend VMs.</p>
<p>For some more critical or vulnerable services like Apache Guacamole &amp; PhpMyAdmin I expose them with Cloudflare Tunnels behind Cloudflare Access for added security.</p>
<p><img loading="lazy" src="/images/homelab_2025_exposed.webp">
<sup>Diagram of everything I have directly exposed to the Internet.</sup></p>
<h2 id="what-im-running-on-it">What I&rsquo;m running on it<a hidden class="anchor" aria-hidden="true" href="#what-im-running-on-it">#</a></h2>
<h3 id="kasm-workspaces"><a href="https://kasmweb.com">Kasm Workspaces</a><a hidden class="anchor" aria-hidden="true" href="#kasm-workspaces">#</a></h3>
<p>This is a software that lets you run desktops or browsers in containers on your server and stream them in browser to your local machine over local network or the internet. I use it for running Kali Linux labs for penetration testing and spinning up a browser when DNS changes are taking a while to update on my machine.</p>
<p>It may also get a lot more use during my Tafe courses (If I get in), since I&rsquo;ll be taking an M4 Macbook Air I won&rsquo;t be able to run x86 Linux VMs but this service will let me do that.</p>
<p><img loading="lazy" src="/images/kali_linux.webp">
<sup>A Kali Linux container running on my Kasm VM.</sup></p>
<h3 id="pterodactyl-panel--wings"><a href="https://pterodactyl.io">Pterodactyl Panel &amp; Wings</a><a hidden class="anchor" aria-hidden="true" href="#pterodactyl-panel--wings">#</a></h3>
<p>This allows me to create and manage all of my game servers with a clean web interface while using secure isolated docker containers on the backend and provide game servers to friends or the local community.</p>
<h3 id="gitea"><a href="https://about.gitea.com">Gitea</a><a hidden class="anchor" aria-hidden="true" href="#gitea">#</a></h3>
<p>A self-hosted GitHub/GitLab alternative, I trust GitHub more with durability so I mainly use my Gitea server for mirrors incase something happens to GitHub or my account on it.</p>
<h3 id="tor-relay-middle"><a href="https://torproject.org">Tor Relay (Middle)</a><a hidden class="anchor" aria-hidden="true" href="#tor-relay-middle">#</a></h3>
<p>Tor is a decentralized system for anonymous communication that hides a users ip address by routing their internet traffic through a series of volunteer-run, encrypted relays.</p>
<p>I&rsquo;m one of the volunteers your traffic gets routed through when using the network, I run a middle relay as its the least dangerous when it comes to law enforcement knocking at your door asking for traffic logs (If a criminal uses your relay for illegal activities).</p>
<h3 id="vps-servers">VPS Servers<a hidden class="anchor" aria-hidden="true" href="#vps-servers">#</a></h3>
<p>I operate a small service for friends or people in my local community offering small linux VMs hosted in my homelab for free - find more about how that works <a href="/posts/vps-service/">here</a>.</p>
<h2 id="reliability">Reliability<a hidden class="anchor" aria-hidden="true" href="#reliability">#</a></h2>
<p>My goal of building my own hosting platform more reliable than a proper hosting provider is pretty much impossible without being in a datacenter, as homes typically don&rsquo;t have multiple internet lines or onsite diesel generators. However, I&rsquo;m in the position where I can achieve relatively close to that level with my setup or at least good enough for my needs.</p>
<ul>
<li><strong>Power:</strong>  Extremely reliable, I live in a fairly new area with pretty solid power infrastructure. My next upgrade will definitely be adding a UPS.</li>
<li><strong>Internet:</strong> I haven&rsquo;t had a single outage on my Internet line, speeds are always consistent with no congestion.</li>
<li><strong>Services Interfering</strong>: All services run in their own VMs with strict resource allocations. If one service crashes or maxxes out resources, nothing else is affected.</li>
</ul>
<h3 id="backups">Backups<a hidden class="anchor" aria-hidden="true" href="#backups">#</a></h3>
<p>I follow the industry-standard 3-2-1 rule where you have a copy on production, an onsite backup and an offsite backup. I run a Proxmox Backup Server onsite which is then sent up to Backblaze B2.</p>
<h3 id="monitoring">Monitoring<a hidden class="anchor" aria-hidden="true" href="#monitoring">#</a></h3>
<p>Even though I do want to setup a proper onsite monitoring system with Prometheus &amp; Grafana as a future project, HetrixTools is super easy to setup and does everything I need it to do - monitor uptime, system resources, network usage and active processes of each Node &amp; VM.</p>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>Even though my Homelab is in a great state for my needs, it can always improve, a few things I still want to do with it include:</p>
<ul>
<li>Setup an onsite monitoring system with Prometheus &amp; Grafana</li>
<li>Add a UPS to protect data integrity and keep systems up during short power outages</li>
<li>Build a proper server rack and add more compute nodes (Including a proper storage server with multiple TBs of storage)</li>
</ul>
<p>And more stuff will definitely come up throughout the years.</p>
<p>Thanks for reading.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/servers/">Servers</a></li>
      <li><a href="http://localhost:1313/tags/homelab/">Homelab</a></li>
      <li><a href="http://localhost:1313/tags/self-hosting/">Self-Hosting</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>© Alecks 2025</span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
